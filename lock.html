<!DOCTYPE html>
<html lang="en">
<head>
	<title>XYZ</title>
	<meta charset="utf-8">
	<meta name="viewport" content="width=device-width, initial-scale=1">
	<link rel="shortcut icon" href="favicon.ico"/>
	<link rel="stylesheet" href="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/css/bootstrap.min.css">
	<link href="css/style.css" rel="stylesheet"/>
	<link href="css/font-awesome.css" rel="stylesheet"/>
	<link href="css/bootstrap-square.css" rel="stylesheet"/>
	
	<script src="https://ajax.googleapis.com/ajax/libs/jquery/1.12.2/jquery.min.js"></script>
	<script src="http://maxcdn.bootstrapcdn.com/bootstrap/3.3.6/js/bootstrap.min.js"></script>

</head>

<body>

<div class="container">

	<div class="container-fluid page-border no-padding">

		<div class="row no-margin navbar-colour" style="min-height:80px;">
		
			<div class="col-xs-1" style="min-width:80px; min-height:70px;">
				<img class="img-responsive pull-left pointable" onclick="window.location.href='index.html'" src="img/logo.png" style="margin-top:6px; min-width:70px; min-height:70px;"/>
			</div>
			
			<div class="col-xs-10 no-padding">
				<h2 class="navbar-brand pointable main-menu" style="padding-left:5px; font-size:29px;" onclick="window.location.href='index.html'" >Main Menu</h2>
				<h2 class="navbar-brand pointable-default" style="padding-left:0px; font-size:29px;"> > Locks</h2>
				<h2 class="navbar-brand pointable-default pull-right" style="padding-right:0px; font-size:20px;" >Rebecca Stones</h2>
			</div>
			
			<div class="col-xs-1 no-padding" style="padding-right:20px">
				<div class="menu-options" style="height:80px;">
					<i class="fa fa-bars fa-3x pull-right pointable left-border" style="padding-left:15px; text-align:center; color:white;" aria-hidden="true"></i>
				</div>
			</div>

		</div>
		
	</div>
	
	<div class="container-fluid page-border no-padding">
	
		<div class="row" style="padding-left:15px; padding-right:15px;">
		
			<div id="lockList" class="col-xs-3 right-border list-group-colour" style="padding-right:0px; padding-left:0px;">
				<div class="list-group no-margin sharp-edge">
					<div onclick="loadDoorControl(this);" id="back" class="list-group-item item-colour active-list">Back Door <i class="fa fa-unlock-alt fa-2x pull-right" aria-hidden="true"></i></div>	
					<div onclick="loadDoorControl(this);" id="front" class="list-group-item item-colour">Front Door <i class="fa fa-lock fa-2x pull-right" aria-hidden="true"></i></div>
					<div onclick="loadDoorControl(this);" id="garageD" class="list-group-item item-colour">Garage Door<i class="fa fa-lock fa-2x pull-right" aria-hidden="false"></i></div>					
					<div onclick="loadWindowControl(this);" id="garageW" class="list-group-item item-colour">Garage Windows<i class="fa fa-lock fa-2x pull-right" aria-hidden="false"></i></div>
					<div onclick="loadWindowControl(this);" id="living" class="list-group-item item-colour">Living Room Windows<i class="fa fa-lock fa-2x pull-right" aria-hidden="true"></i></div>
					<div onclick="loadWindowControl(this);" id="kitchen" class="list-group-item item-colour">Kitchen Windows<i class="fa fa-lock fa-2x pull-right" aria-hidden="true"></i></div>
					<div onclick="loadWindowControl(this);" id="guest" class="list-group-item item-colour">Guest Room Windows<i class="fa fa-lock fa-2x pull-right" aria-hidden="true"></i></div>
					<div onclick="loadWindowControl(this);" id="master" class="list-group-item item-colour">Master Bedroom Windows<i class="fa fa-lock fa-2x pull-right" aria-hidden="true"></i></div>	
					<div onclick="loadWindowControl(this);" id="wanda" class="list-group-item item-colour">Wanda's Bedroom Windows<i class="fa fa-lock fa-2x pull-right" aria-hidden="true"></i></div>	
				</div>
			</div>
		
			
			<div id="lockControl" class="col-xs-9 list-group-colour" style="padding-right:0px">
			
				<h2>Change Status</h2>
			
				<div class="row" style="padding-top:10px; padding-right:10px;">
				
					<div class="col-xs-6">
						<button type="button" id="lockBtn" class="btn btn-primary center-block btn-block" onclick="lock(this)">Lock</button>
					</div>
					
					<div class="col-xs-6">
						<button type="button" id="unlockBtn" class="btn btn-primary center-block btn-block disabled" onclick="unlock(this)">Unlock</button>
					</div>
					
				</div>
				
				<div class="separator"></div>
				
				<div class="row">
					<div class="col-xs-12">
					
						<h2>Change PIN</h2>

							<div class="row" style="padding-top:10px;">
							
								<div class="col-xs-12">
									<input type="text" onkeyup="toggleButton(this)" class="form-control" style="width:25%;" placeholder="Current PIN">
								</div>
								
							</div>
							
							<div class="row" style="padding-top:10px;">
							
								<div class="col-xs-12">
									<input type="text" id="newPin" class="form-control" style="width:25%;" placeholder="New PIN" disabled>
								</div>
								
							</div>
							
							<div class="row" style="padding-top:10px; padding-bottom:10px;">
							
								<div class="col-xs-12">
									<button type="button" id="change" class="btn btn-primary disabled">Change</button>
									<button type="button" id="cancel" class="btn btn-primary disabled">Cancel</button>
								</div>

							</div>
						
					</div>
				</div>
				
			</div>

		</div>

	</div>
	
</div>

<script>
var currentRoom = null;
var currentControl = null;
var currentList = null;

$(document).ready(function(){
	if (sessionStorage.getItem("firstDoor") == "no"){
		//do nothing
	} else {
		sessionStorage.setItem("firstDoor", "yes");
	}
	
	loadDoorList();
	loadDoorControl();

});

function lock(e){
	var temp = "#" + currentRoom + " > i";
	$(temp).removeClass("fa-unlock-alt");
	$(temp).addClass("fa-lock");
	
	$("#lockBtn").addClass("disabled");
	$("#unlockBtn").removeClass("disabled");
	
	currentControl = JSON.stringify($("#lockControl").html());	
	sessionStorage.setItem(currentRoom, currentControl);
}

function unlock(e){
	var temp = "#" + currentRoom + " > i";
	$(temp).removeClass("fa-lock");
	$(temp).addClass("fa-unlock-alt");

	$("#lockBtn").removeClass("disabled");
	$("#unlockBtn").addClass("disabled");
	
	currentControl = JSON.stringify($("#lockControl").html());	
	sessionStorage.setItem(currentRoom, currentControl);
}

function loadDoorList(){
	
	if ((sessionStorage.getItem("lockList") != null) && (sessionStorage.getItem("lockList") != "")){
		currentList = JSON.parse(sessionStorage.getItem("lockList"));
		$("#lockList").html(currentList);
	} else {
		$("#lockList").load("http://homeauto.azurewebsites.net/lockList.html");
	}
	
	window.onbeforeunload = function() {
		currentList = JSON.stringify($("#lockList").html());	
		sessionStorage.setItem("lockList", currentList);
	}
}

function loadDoorControl(e){

	currentControl = JSON.stringify($("#lockControl").html());	
	sessionStorage.setItem(currentRoom, currentControl);

	if (typeof e === "undefined"){
		currentRoom = "back";
	}
	
	if (sessionStorage.getItem("firstDoor") == "yes"){
		currentRoom = "back";	
		sessionStorage.setItem("firstDoor", "no");

	} else {
		
		if (typeof e !== "undefined"){
			currentRoom = e.id;
		}
		
		if ((sessionStorage.getItem(currentRoom) != null) && (sessionStorage.getItem(currentRoom) != "")){ //load cached
			currentControl = JSON.parse(sessionStorage.getItem(currentRoom));
			$("#lockControl").html(currentControl);	
		} else {	//load new
			$("#lockControl").load("http://homeauto.azurewebsites.net/doorControl.html");
		}
		
		$(".list-group-item").removeClass("active-list");
		$("#" + currentRoom).addClass("active-list");
		
	}
	
	window.onbeforeunload = function() {
		currentControl = JSON.stringify($("#lockControl").html());	
		sessionStorage.setItem(currentRoom, currentControl);
	}
	
}

function loadWindowControl(e){

	currentControl = JSON.stringify($("#lockControl").html());	
	sessionStorage.setItem(currentRoom, currentControl);
	
	currentRoom = e.id;
	
	if ((sessionStorage.getItem(currentRoom) != null) && (sessionStorage.getItem(currentRoom) != "")){ //load cached
		currentControl = JSON.parse(sessionStorage.getItem(currentRoom));
		$("#lockControl").html(currentControl);	
	} else {	//load new
		$("#lockControl").load("http://homeauto.azurewebsites.net/windowControl.html");
	}
	
	$(".list-group-item").removeClass("active-list");
	$("#" + currentRoom).addClass("active-list");

}

function toggleButton(e){
	var temp = e.value;
	
	if (temp != null && temp != ""){
		$('#change').removeClass("disabled");
		$('#cancel').removeClass("disabled");
		$('#newPin').prop('disabled', false);
	} else {
		$('#change').addClass("disabled");
		$('#cancel').addClass("disabled");
		$('#newPin').prop('disabled', true);
	}

}
</script>

</body>

</html>
